# 作業ログ - 2025-12-18

## プロジェクト概要

**ニュース記事バイアスチェッカー** (Chrome拡張機能)
- ニュース記事の政治的バイアス（左派/中立/右派）をAIが分析
- OpenAI, Gemini, Claude の3つのAPIに対応

## 実施内容

- [x] QWENが作成した非動作の拡張機能を修正
- [x] UIをCLAUDE.mdデザインガイドラインに準拠（パステル水色系）
- [x] ダークモード/ライトモード対応
- [x] APIモデルを最新版に更新
- [x] バイアス分析プロンプトの日本政治対応強化
- [x] ページ移動・タブ切り替え時の自動更新機能追加
- [x] ストレージをsync→localに変更
- [x] README.md作成
- [x] GitHubリポジトリ作成・プッシュ

## 修正したバグ

| バグ | 原因 | 修正内容 |
|------|------|----------|
| 分析が動作しない | BIAS_PROMPTが空 | プロンプト内容を正しく設定 |
| JSON解析エラー | 正規表現が壊れていた (`{[sS]*?}`) | `{[\s\S]*?}` に修正 |
| Claude APIエラー | CORSヘッダー不足 | `anthropic-dangerous-direct-browser-access` ヘッダー追加 |
| 再分析がスピナーのまま | `chrome.scripting.executeScript`内から`chrome.runtime`にアクセス不可 | popup.jsでテキスト抽出後にbackgroundに送信 |
| 右寄り記事が中立判定 | プロンプトが一般的すぎた | 日本の政治状況に特化した判定基準を追加 |
| ページ移動で結果が古いまま | URL変更検知なし | URL追跡とSPA対応を追加 |

## 変更ファイル

- `manifest.json` - バージョン 1.0 → 1.3.0
- `background.js` - API呼び出し、プロンプト、エラーハンドリング全面修正
- `content.js` - URL変更検知、pageshow対応追加
- `popup.js` - URL比較、タイムアウト処理追加
- `popup.html` - パステル水色系UIに刷新
- `options.html` - UIデザイン更新
- `options.js` - storage.sync → storage.local
- `README.md` - 新規作成

## 技術スタック

- Chrome Extension Manifest V3
- Vanilla JavaScript
- CSS Variables（ダークモード対応）
- AI APIs:
  - OpenAI GPT-4o-mini
  - Google Gemini 2.0 Flash
  - Anthropic Claude 3.5 Haiku

## GitHubリポジトリ

https://github.com/sayasaya8039/News_Article_Bias_Checker

## バージョン履歴

### v1.3.0 (現在)
- ページ移動・タブ切り替え時の自動更新機能追加
- URL変更検知（SPA対応）

### v1.2.0
- 日本の政治状況に特化したバイアス判定基準に改善
- プロンプトの大幅強化

### v1.1.6
- 設定をローカルストレージに保存するよう変更

### v1.1.5
- デバッグログ追加
- エラーハンドリング強化

### v1.1.0
- UIをパステル水色系デザインに刷新
- ダークモード/ライトモード自動対応
- APIモデルを最新版に更新

### v1.0.0
- 初回リリース（QWEN作成、動作せず）

## 次回TODO

- [ ] スクリーンショット追加（README.md）
- [ ] Chrome Web Store公開検討
- [ ] 分析精度の継続的な改善
